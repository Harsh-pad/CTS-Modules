<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Local Community Event Portal</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
    <style>
        /* Internal CSS for Task 1 & 3 & 5 & general styling */
        /* Task 1: Use an embedded <style> tag in the <head> to define body background. */
        /* Task 4: Add a background image to the body with fallback color */
        body {
            font-family: 'Roboto', Arial, sans-serif; /* Task 5: Set font-family from Google Font */
            min-height: 100vh;
            background: url('https://media.istockphoto.com/id/494182874/photo/blur-festival-events-market-outdoor-with-people.jpg?s=612x612&w=0&k=20&c=raFCPzh6a5OBQdAUICl8F0kZZpk6yWr-PRHPhaEKK5s=') no-repeat center center fixed;
            background-size: cover;
            position: relative;
            color: #333;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 40px 20px;
            margin: 0;
            font-size: 16px; /* Task 5: Set base font-size */
        }

        /* Task 3: ID selector #mainHeader for the banner */
        #mainHeader h1 { /* Task 1: Apply an inline style to make one heading red. */
            /* The color for this specific h1 is now handled by the inline style in the span below */
        }

        /* Task 3: ID selector #welcomeBanner (already existed, kept for consistency) */
        #welcomeBanner {
            background-color: #cfe2f3; /* Light blue */
            color: #333;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            border-radius: 5px;
            text-align: center;
        }

        /* Task 5: Text styling for highlight */
        .highlight {
            background-color: #fffacd; /* Light yellow */
            padding: 2px 5px;
            border-radius: 3px;
            font-weight: bold; /* Added font-weight */
        }

        /* Task 8: Add outline to highlight selected fields in a form */
        .event-form input:focus,
        .event-form select:focus,
        .event-form textarea:focus {
            outline: 2px solid #a7d9b9; /* Highlight with a green outline */
            border-color: #8ccf9f;
        }
    </style>
</head>
<body>

    <header>
    <h1><span style="color: rgb(74, 74, 74);">LOCAL COMMUNITY EVENT PORTAL</span></h1>
    <nav>
        <a href="#home">Home</a>
        <a href="#events">Events</a>
        <a href="#register">Register for Events</a>
        <a href="#feedback">Feedback</a>
        <a href="#video">Event Video</a> <a href="#preferences">Preferences</a>
        <a href="#news-bulletin">Community Bulletin</a> <a href="#contact">Contact</a>
    </nav>
    </header>

    <main>
        <section id="home">
            <h2>Welcome to Your Community Hub!</h2>
            <div id="welcomeBanner">
                <h3>Hello, Resident!</h3>
                <p>Explore events and services. Stay connected with your community!</p>
            </div>
            <p>Your go-to place for all local community activities.</p>
        </section>

        <section id="events">
            <h2>Events</h2>
            <p>Browse through and get a glimpse of what's coming next!</p>
            <div class="image-gallery">
                <table>
                    <tr>
                        <td>
                            <img src="a11.jfif" alt="Event 1" title="Music Fest" class="event-image" id="img1">
                            <div class="event-caption">Music Fest</div>
                        </td>
                        <td>
                            <img src="a2.jpg" alt="Event 2" title="Art Workshop" class="event-image" id="img2">
                            <div class="event-caption">Art Workshop</div>
                        </td>
                        <td>
                            <img src="a33.jpg" alt="Event 3" title="Food Carnival" class="event-image" id="img3">
                            <div class="event-caption">Food Carnival</div>
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <img src="a4.jpg" alt="Event 4" title="Yoga Morning" class="event-image" id="img4">
                            <div class="event-caption">Yoga Morning</div>
                        </td>
                        <td>
                            <img src="a5.jpg" alt="Event 5" title="Clean-Up Drive" class="event-image" id="img5">
                            <div class="event-caption">Clean-Up Drive</div>
                        </td>
                        <td>
                            <img src="a6.jpg" alt="Event 6" title="Kids Fun Fair" class="event-image" id="img6">
                            <div class="event-caption">Kids Fun Fair</div>
                        </td>
                    </tr>
                </table>
            </div>
        </section>

        <section id="register">
            <h2>Event Registration</h2>
            <form class="event-form" onsubmit="event.preventDefault(); submitRegistrationForm();">
                <label for="name">Full Name:</label>
                <input type="text" id="name" name="name" placeholder="John Doe" required autofocus>

                <label for="email">Email:</label>
                <input type="email" id="email" name="email" placeholder="john.doe@example.com" required>

                <label for="eventDate">Preferred Date:</label>
                <input type="date" id="eventDate" name="eventDate" required>

                <label for="eventType">Event Type:</label>
                <select id="eventType" name="eventType" required>
                    <option value="">--Select an Event Type--</option>
                    <option value="musicfest">Music Festival</option>
                    <option value="artworkshop">Art Work Shop</option>
                    <option value="food">Food Carnival</option>
                    <option value="yoga">Yoga Morning</option>
                    <option value="cleanup">Clean-Up Drive</option>
                    <option value="kids">Kids Fun Fair</option>
                </select>

                <label for="message">Your Message:</label>
                <textarea id="message" name="message" placeholder="Any specific requests or questions?" rows="4"></textarea>

                <button type="submit">Register Now</button>
            </form>
        </section>

        <section id="feedback">
            <h2>Event Feedback</h2>
            <form class="event-form">
                <label for="phoneNumber">Phone Number:</label>
                <input type="text" id="phoneNumber" placeholder="e.g., 123-456-7890" onblur="validatePhoneNumber()">
                <div id="phoneError" style="color: red; grid-column: span 2; font-size: 0.9em;"></div>

                <label for="feedbackEventType">Event Attended:</label>
                <select id="feedbackEventType" onchange="displayEventFee()">
                    <option value="">--Select Event--</option>
                    <option value="Community Fair">Music Festival ($10)</option>
                    <option value="Book Reading">Art Work Shop (Free)</option>
                    <option value="Sports Day">Food Carnival ($5)</option>
                    <option value="Art Workshop">Yoga Morning ($25)</option>
                    <option value="Art Workshop">Clean-Up Drive ($20)</option>
                    <option value="Art Workshop">Kids Fun Fair ($10)</option>
                </select>
                <div id="eventFeeDisplay" style="grid-column: span 2; font-size: 0.9em; color: #555;"></div>

                <label for="feedbackTextarea">Your Feedback:</label>
                <textarea id="feedbackTextarea" onkeyup="countCharacters(this)" rows="6" placeholder="Share your experience..."></textarea>
                <div id="charCount" style="grid-column: span 2; text-align: right; font-size: 0.8em; color: #777;">0 characters</div>

                <button type="button" onclick="showFeedbackConfirmation()">Submit Feedback</button>
            </form>
        </section>

        <section id="video">
            <h2>Our Community Carnival: A Look Back! </h2>
            <p> See the highlights from a recent successful community event</p>
            <section id="video-invite" style="text-align:center; margin-bottom: 20px;">
                <h3>Event Video</h3>
                <iframe
                    src="https://www.facebook.com/plugins/video.php?href=https://www.facebook.com/watch/?v=541731331867163"
                    width="560"
                    height="315"
                    style="border:none;overflow:hidden"
                    scrolling="no"
                    frameborder="0"
                    allowfullscreen="true"
                    allow="autoplay; clipboard-write; encrypted-media; picture-in-picture; web-share">
                </iframe>
                <div id="videoStatus" style="margin-top: 10px; font-weight: bold;"></div>
            </section>
        </section>

        <section id="news-bulletin">
            <h2>Community Bulletin: Latest News</h2>
            <div class="news-content">
                <h3>Local Park Renovation Project Kicks Off</h3>
                <p>The highly anticipated renovation project for Central Community Park officially began this week. Local residents gathered for a groundbreaking ceremony, eager to see the transformation of their beloved green space. The project includes new playground equipment, improved walking trails, and enhanced picnic areas. Completion is expected by late autumn.</p>
                <p>The city council has allocated significant funds to ensure the park becomes a vibrant hub for all ages. Community feedback sessions were instrumental in shaping the final design, emphasizing accessibility and sustainability. Volunteers are also being sought for planting days in the coming months.</p>
                <h3>Annual Charity Run Exceeds Fundraising Goals</h3>
                <p>This year's "Run for a Cause" charity event shattered all previous fundraising records, collecting over $50,000 for local youth programs. Hundreds of participants, from seasoned runners to families pushing strollers, took part in the 5k and 10k races. The spirit of camaraderie and community support was palpable throughout the day.</p>
                <p>Organizers expressed immense gratitude to all sponsors, volunteers, and participants. The funds raised will directly benefit after-school programs, mentorship initiatives, and sports leagues, providing invaluable opportunities for the community's children and teenagers.</p>
            </div>
        </section>

        <section id="preferences">
            <h2>User Preferences</h2>
            <p>Select your preferred event type, and we'll remember it for your next visit!</p>
            <form class="event-form">
                <label for="preferredEventType">Preferred Event Type:</label>
                <select id="preferredEventType" onchange="savePreference()">
                    <option value="none">--Choose one--</option>
                    <option value="musicfest">Music Festival</option>
                    <option value="artworkshop">Art Work Shop</option>
                    <option value="food">Food Carnival</option>
                    <option value="yoga">Yoga Morning</option>
                    <option value="cleanup">Clean-Up Drive</option>
                    <option value="kids">Kids Fun Fair</option>
                </select>
                <button type="button" class="action-button" onclick="clearPreferences()">Clear Preferences</button>
                <p id="preferenceMessage" style="grid-column: span 2; margin-top: 10px; font-size: 0.9em; color: #555;"></p>
            </form>
        </section>

        <section id="contact">
            <h2>Contact Us & Find Nearby Events</h2>
            <p>Have questions or need assistance? Reach out to us!</p>
            <p>Email: <a href="mailto:info@communityportal.org">info@communityportal.org</a></p>
            <p>Phone: (123) 456-7890</p>

            <h3>Locate Nearest Events</h3>
            <p>Click the button below to find your current location and see nearby events on a map.</p>
            <button class="action-button" onclick="findNearbyEvents()">Find Nearby Events</button>
            <p id="locationDisplay" style="margin-top: 10px; font-size: 0.9em; color: #555;"></p>
            <p id="mapLinkDisplay" style="margin-top: 10px; font-size: 0.9em;"></p>
        </section>

    </main>

    <footer>
        <p>© 2025 Local Community Event Portal. All rights reserved.</p>
        <p>Designed for the <span class="highlight">community</span>, by the community.</p>
    </footer>

    <script>
        // Task 5: Event Registration Form Submission
        function submitRegistrationForm() {
            const name = document.getElementById('name').value;
            const email = document.getElementById('email').value;
            const eventDate = document.getElementById('eventDate').value;
            const eventType = document.getElementById('eventType').value;

            alert(`Registration Confirmed!\\n\\nThank you, ${name}, for registering.\\nA confirmation email has been sent to ${email}.\\nYou are registered for a ${eventType} event on ${eventDate}.\\nWe look forward to seeing you!`);
            // For demonstration, clearing the form would be good in a real app
            // document.querySelector('.event-form').reset();
        }

        // Task 6: Event Handling - Phone Number Validation
        function validatePhoneNumber() {
            const phoneInput = document.getElementById('phoneNumber');
            const phoneError = document.getElementById('phoneError');
            // Updated regex for more robust phone number validation (allowing spaces, hyphens, or just digits)
            const phonePattern = /^(\\d{3}[-.\\s]?\\d{3}[-.\\s]?\\d{4})$/;

            if (phoneInput.value === "") {
                phoneError.textContent = "";
                phoneInput.style.borderColor = '#ddd'; // Reset border color
            } else if (!phonePattern.test(phoneInput.value)) {
                phoneError.textContent = "Please enter a valid phone number (e.g., 123-456-7890).";
                phoneInput.style.borderColor = 'red';
            } else {
                phoneError.textContent = "";
                phoneInput.style.borderColor = '#ddd';
            }
        }

        // Task 6: Event Handling - Display Event Fee
        function displayEventFee() {
            const dropdown = document.getElementById('feedbackEventType');
            const feeDisplay = document.getElementById('eventFeeDisplay');
            const selectedOption = dropdown.options[dropdown.selectedIndex].text;

            if (selectedOption.includes('($')) {
                feeDisplay.textContent = `Event Fee: ${selectedOption.split('(')[1].replace(')', '')}`;
            } else if (selectedOption.includes('(Free)')) {
                feeDisplay.textContent = 'Event Fee: Free';
            } else {
                feeDisplay.textContent = '';
            }
        }

        // Task 6: Event Handling - Show Feedback Confirmation (Custom Message Box)
        function showFeedbackConfirmation() {
            const messageBox = document.createElement('div');
            messageBox.style.cssText = `
                position: fixed;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                background-color: #f0f0f0;
                border: 1px solid #ccc;
                padding: 20px;
                border-radius: 8px;
                box-shadow: 0 4px 8px rgba(0,0,0,0.2);
                z-index: 1001;
                text-align: center;
                color: #333;
            `;
            messageBox.innerHTML = `
                <p>Thank you for your feedback!</p>
                <button onclick="this.parentNode.remove()" style="
                    padding: 8px 15px;
                    background-color: #a7d9b9;
                    color: #333;
                    border: none;
                    border-radius: 4px;
                    cursor: pointer;
                    margin-top: 15px;
                ">OK</button>
            `;
            document.body.appendChild(messageBox);
        }

        // Task 6: Event Handling - Character Counter for Feedback
        function countCharacters(textarea) {
            const charCount = document.getElementById('charCount');
            charCount.textContent = `${textarea.value.length} characters`;
        }

        // Task 6: Event Handling - Double click to enlarge image
        document.addEventListener('DOMContentLoaded', () => {
            const images = document.querySelectorAll('.event-image');
            images.forEach(img => {
                img.ondblclick = function() {
                    enlargeImage(this);
                };
            });
        });

        function enlargeImage(imgElement) {
            const existingEnlarged = document.querySelector('.enlarged-image');
            if (existingEnlarged) {
                existingEnlarged.remove();
            }

            const enlargedImg = document.createElement('img');
            enlargedImg.src = imgElement.src;
            enlargedImg.alt = imgElement.alt;
            enlargedImg.classList.add('enlarged-image');
            enlargedImg.onclick = function() {
                this.remove(); // Remove when clicked again
            };
            document.body.appendChild(enlargedImg);
        }

        // Task 7: Video and Media Events
        document.getElementById('videoStatus').textContent = "Video is ready to play.";

        // Task 7: Warning for unfinished form (onbeforeunload)
        window.onbeforeunload = function() {
            const regFormInputs = document.querySelectorAll('#register input, #register select, #register textarea');
            let regFormChanged = false;
            for (const input of regFormInputs) {
                if (input.value && input.value !== input.defaultValue) {
                    regFormChanged = true;
                    break;
                }
            }

            const feedbackTextarea = document.getElementById('feedbackTextarea');
            if (feedbackTextarea && feedbackTextarea.value.length > 0) {
                regFormChanged = true;
            }

            if (regFormChanged) {
                return "You have unsaved changes. Are you sure you want to leave?";
            }
        };

        // Task 8: Saving User Preferences (localStorage)
        document.addEventListener('DOMContentLoaded', () => {
            const preferredEventType = localStorage.getItem('preferredEventType');
            const selectElement = document.getElementById('preferredEventType');
            if (preferredEventType) {
                selectElement.value = preferredEventType;
                document.getElementById('preferenceMessage').textContent = `Your last preferred event type was "${selectElement.options[selectElement.selectedIndex].text}".`;
            } else {
                document.getElementById('preferenceMessage').textContent = "No preferred event type saved yet.";
            }

            // Example of sessionStorage (not explicitly used for a "preference" but for demonstration)
            sessionStorage.setItem('lastVisitedPage', window.location.href);
            console.log('Session storage - last visited page:', sessionStorage.getItem('lastVisitedPage'));
        });

        function savePreference() {
            const selectElement = document.getElementById('preferredEventType');
            const selectedValue = selectElement.value;
            if (selectedValue && selectedValue !== 'none') {
                localStorage.setItem('preferredEventType', selectedValue);
                document.getElementById('preferenceMessage').textContent = `Your preferred event type "${selectElement.options[selectElement.selectedIndex].text}" has been saved.`;
            } else {
                localStorage.removeItem('preferredEventType');
                document.getElementById('preferenceMessage').textContent = "Preferred event type cleared.";
            }
        }

        function clearPreferences() {
            localStorage.clear();
            sessionStorage.clear();
            document.getElementById('preferredEventType').value = 'none';
            document.getElementById('preferenceMessage').textContent = "All preferences cleared from local and session storage.";
            console.log("Local Storage Cleared:", localStorage.length === 0);
            console.log("Session Storage Cleared:", sessionStorage.length === 0);
        }

        // Task 9: Geolocation
        function findNearbyEvents() {
            const locationDisplay = document.getElementById('locationDisplay');
            const mapLinkDisplay = document.getElementById('mapLinkDisplay');
            locationDisplay.textContent = 'Finding your location...';
            mapLinkDisplay.innerHTML = '';

            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(
                    (position) => {
                        const lat = position.coords.latitude;
                        const lon = position.coords.longitude;
                        locationDisplay.textContent = `Latitude: ${lat.toFixed(4)}, Longitude: ${lon.toFixed(4)}`;

                        // Corrected Google Maps URL for nearby search - search for "events"
                        const mapLink = `https://www.google.com/maps/search/events/@${lat},${lon},14z`;
                        mapLinkDisplay.innerHTML = `<p>Click here to see <a href="${mapLink}" target="_blank">Nearby Events on Google Maps</a>.</p>`;
                    },
                    (error) => {
                        let errorMessage = 'Error getting location: ';
                        switch (error.code) {
                            case error.PERMISSION_DENIED:
                                errorMessage += 'User denied the request for Geolocation.';
                                break;
                            case error.POSITION_UNAVAILABLE:
                                errorMessage += 'Location information is unavailable.';
                                break;
                            case error.TIMEOUT:
                                errorMessage += 'The request to get user location timed out.';
                                break;
                            case error.UNKNOWN_ERROR:
                                errorMessage += 'An unknown error occurred.';
                                break;
                        }
                        locationDisplay.textContent = errorMessage;
                        console.error('Geolocation Error:', error); // For debugging
                    },
                    {
                        enableHighAccuracy: true,
                        timeout: 5000,
                        maximumAge: 0
                    }
                );
            } else {
                locationDisplay.textContent = "Geolocation is not supported by this browser.";
            }
        }

        // Task 10: Debugging with Chrome DevTools
        console.log("Portal script loaded successfully!");

    </script>
</body>
</html>